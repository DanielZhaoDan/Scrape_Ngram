# -*- coding: utf-8 -*-
import re
import xlwt
import sys
from datetime import datetime
from html.parser import HTMLParser
import html
import os
import xlrd
import requests
import time
import ssl
import json
import operator

P_ID = 1
PAGE_SIZE = 1500
# 12764-13245,13398

sheet1_data = [['Profile ID', 'Name', 'Return', 'Risk Score', 'Copiers', 'Copiers Change', 'Weekly DD', 'Country', 'Link to profile', 'Customer ID']]
sheet2_data = [['Profile ID', 'Name', 'Type of INV', 'Return', 'Trades per week', 'Avg holding time in Hours', 'Active since', 'Profitable Weeks']]
sheet3_data = [['Profile ID	Name', 'Action', 'Item', 'Open', 'Close', 'P/L']]

cookie = 'visid_incap_20269=iy+fuzuMQ9izdXR9RqzNAsPp0VoAAAAAQUIPAAAAAAAzdkBSKH65RMZXTwjL/m/6; hp_preferences=%7B%22locale%22%3A%22en-us%22%7D; etoro_rmk_visit_v1=a-92; visid_incap_773285=yWlpLKeQQwa61e7X/yYunlPt0VoAAAAAQUIPAAAAAAAh1mBFR/kKlezHbmm1E01/; _ym_uid=1523707228850677886; mp_a46ed246b149568e354e40df267dcbe2_mixpanel=%7B%22distinct_id%22%3A%20%22162c407290f207-03af83abba57de-13366f50-fa000-162c4072910507%22%2C%22%24initial_referrer%22%3A%20%22%24direct%22%2C%22%24initial_referring_domain%22%3A%20%22%24direct%22%7D; __atuvc=1%7C16; posts_view=a%3A1%3A%7Bi%3A0%3Bs%3A5%3A%2224944%22%3B%7D; etoro_first_page=https%3A//www.etoro.com/; TMIS2=9a74f8b353780f2fbe59d8dc1d9cd901437be0b823f8ee60d0ab36264e2503c33b5fc499a34f5268edfa31d267e3f1cd92d9687fab4eb67a4a6f6062b2b4c686b2ba5ee755fb8858d673749f5b8b84e64dd33773da105979658729f725717a775676aed7a769df8e3a45c9023880; _ga=GA1.2.96972698.1523706313; _gid=GA1.2.605887730.1523706313; mp_dbbd7bd9566da85f012f7ca5d8c6c944_mixpanel=%7B%22distinct_id%22%3A%20%22162c3f950682a4-09b4588c61d788-13366f50-fa000-162c3f950693af%22%2C%22%24initial_referrer%22%3A%20%22%24direct%22%2C%22%24initial_referring_domain%22%3A%20%22%24direct%22%7D; incap_ses_961_20269=8zxhFxp3kzt8xpoapShWDUnh01oAAAAAdq3WplaMInebndNikFUR+A==; TS01047baf=01f1b32d7e3a0075220a8bf39cdda1b07f8577a8712129208c021dd3df8230bf90ce4efb58dec81d8277c50471206bb88802566cf2'

name_set = set()
id_typeid = {}
TYPEID_NAME = {1: 'Currencies', 2: 'Commodities', 4: 'Indices', 5: 'Stocks', 6: 'ETF', 10: 'Cryptocurrencies'}


def load_ins_dict():
    return {
        1: 'EUR/USD',
        2: 'GBP/USD',
        3: 'NZD/USD',
        4: 'USD/CAD',
        5: 'USD/JPY',
        6: 'USD/CHF',
        7: 'AUD/USD',
        8: 'EUR/GBP',
        9: 'EUR/CHF',
        10: 'EUR/JPY',
        11: 'GBP/JPY',
        12: 'EUR/AUD',
        13: 'EUR/CAD',
        14: 'AUD/JPY',
        15: 'CAD/JPY',
        16: 'CHF/JPY',
        17: 'Oil',
        18: 'Gold',
        19: 'Silver',
        27: 'SPX500',
        28: 'NSDQ100',
        29: 'DJ30',
        30: 'UK100',
        31: 'FRA40',
        32: 'GER30',
        1001: 'Apple',
        1002: 'Alphabet',
        1003: 'Facebook',
        1004: 'Microsoft',
        1005: 'Amazon',
        1006: 'Altaba Inc',
        1007: 'Zynga',
        40: 'Platinum',
        41: 'Palladium',
        42: 'USD/ZAR',
        39: 'USD/HKD',
        37: 'SUI30',
        36: 'JPN225',
        35: 'ITA40',
        34: 'ESP35',
        33: 'AUS200',
        21: 'Copper',
        22: 'Natural Gas',
        1008: 'Alcoa',
        1009: 'American Express CO',
        1010: 'Boeing',
        1011: 'Bank of America Corp',
        1012: 'Caterpillar',
        1013: 'Cisco',
        1014: 'Chevron',
        1015: 'Du-Pont',
        1016: 'Walt Disney',
        1017: 'General Electric Co',
        1018: 'Home Depot Inc',
        1019: 'Hewlett Packard',
        1020: 'IBM',
        1021: 'Intel',
        1022: 'Johnson & Johnson',
        1023: 'JPMorgan Chase & Co',
        1024: 'Coca-Cola',
        1025: 'McDonalds',
        1026: '3M',
        1027: 'Merck',
        1028: 'Pfizer',
        1029: 'Procter & Gamble Co',
        1030: 'AT&T Inc',
        1031: 'Travelers',
        1032: 'UnitedHealth',
        1033: 'United-Technologies',
        1034: 'Verizon',
        1035: 'Wal-Mart',
        1036: 'Exxon-Mobil',
        1037: 'Citigroup',
        1039: 'HSBC',
        1040: 'Manchester United',
        1041: 'Mastercard',
        1042: 'NIKE',
        1043: 'PepsiCo',
        1044: 'Sony',
        1045: 'Toyota',
        1050: 'Colgate-Palmolive',
        1052: 'Siemens',
        100000: 'Bitcoin',
        1100: 'Telecom Argentina SA',
        1101: 'Ternium SA',
        1102: 'Petroleo Brasileiro SA Petrobras',
        1103: 'Vale SA',
        1104: 'Banco Santander SA',
        1105: 'Telefonica SA',
        1106: 'America Movil, S.A.B. de C.V.',
        1107: 'Cemex, S.A.B. de C.V.',
        1108: 'Directv',
        1109: 'Grupo Televisa, S.A.B.',
        1110: 'SanDisk Corp',
        1111: 'Tesla Motors, Inc.',
        1112: 'Ford Motor Co',
        1113: 'Las Vegas Sands Corp',
        1114: 'LinkedIn Corp',
        1115: 'Nokia Oyj',
        1116: 'Potash Corporation of Saskatchewan',
        1117: 'First Solar, Inc.',
        1118: 'Berkshire Hathaway Inc',
        1119: 'Western Union Company',
        1120: 'Gap, Inc.',
        1121: 'Ralph Lauren Corp',
        1122: 'Harley-Davidson Inc',
        1123: 'TripAdvisor Inc',
        1124: 'Electronic Arts, Inc.',
        1125: 'Urban Outfitters Inc.',
        1126: 'Adobe Systems Inc',
        1127: 'Netflix, Inc.',
        1128: 'Motorola Solutions, Inc.',
        1129: 'Western Digital Corporation',
        1130: 'Micron Technology, Inc.',
        1131: 'Abercrombie & Fitch Company',
        1132: 'WisdomTree Emerging Markets',
        1133: 'American Capital Agency Corp.',
        1134: 'Autodesk, Inc.',
        1135: 'Oracle Corporation',
        1136: 'Lockheed Martin Corporation',
        1137: 'NVIDIA Corporation',
        1138: 'FedEx Corporation',
        1139: 'Noble Energy Inc',
        1140: 'Avis Budget Group Inc',
        1141: 'Baidu, Inc.',
        1142: 'Starbucks Corporation',
        1143: 'Amgen Inc',
        1144: 'Activision Blizzard, Inc.',
        1145: 'Check Point Software Technologies',
        1146: 'Mosaic Co',
        1147: 'PetSmart Inc.',
        1148: 'Dr Pepper Snapple Group, Inc.',
        1149: 'Constellation Brands Inc.',
        1153: 'Twitter',
        1200: 'Siemens Aktiengesellschaft',
        2000: 'Anglo American',
        2002: 'Admiral Group',
        2003: 'Aberdeen Asset Management',
        2004: 'Aggreko',
        2005: 'Ashtead Group',
        2006: 'Amec Foster Wheeler Plc',
        2007: 'Antofagasta',
        2008: 'ARM Holdings',
        2009: 'Aviva',
        2010: 'AstraZeneca',
        2011: 'BAE Systems',
        2012: 'Babcock International',
        2013: 'Barclays',
        2014: 'British American Tobacco',
        2015: 'BG Group',
        2016: 'British Land',
        2017: 'BHP Billiton',
        2018: 'Bunzl',
        2019: 'BP',
        2020: 'Burberry Group',
        2021: 'Sky PLC',
        2022: 'BT Group',
        2023: 'Coca Cola Hellenic',
        2024: 'Carnival',
        2025: 'Centrica',
        2026: 'Compass Group',
        2027: 'Capita',
        2028: 'CRH',
        43: 'EUSTX50',
        1201: 'BASF SE',
        2001: 'Associated British Foods',
        2029: 'Diageo',
        2030: 'Experian',
        2031: 'easyJet',
        2032: 'Fresnillo',
        2033: 'G4S',
        2034: 'GKN',
        2035: 'Glencore Plc',
        2036: 'GlaxoSmithKline',
        2037: 'Hargreaves Lansdown',
        2038: 'Hammerson',
        2039: 'HSBC Holdings',
        2040: 'International Consolidated Airlines',
        2041: 'InterContinental Hotels Group',
        2042: 'IMI',
        2043: 'Imperial Brands PLC',
        2044: 'Intertek Group',
        2045: 'ITV',
        2046: 'Johnson Matthey',
        2047: 'Kingfisher',
        2048: 'Land Securities',
        2049: 'Legal & General',
        2050: 'Lloyd\'s',
        2051: 'London Stock Exchange',
        2052: 'Meggitt',
        2053: 'Marks & Spencer',
        2054: 'Mondi',
        2055: 'Melrose Industries',
        2056: 'Morrisons',
        2057: 'National Grid',
        2058: 'Next',
        2059: 'Old Mutual',
        2060: 'Petrofac',
        2061: 'Prudential',
        2062: 'Persimmon',
        2063: 'Pearson',
        2064: 'Reckitt Benckiser',
        2065: 'Royal Bank of Scotland',
        2066: 'Royal Dutch Shell',
        2068: 'Reed Elsevier',
        2069: 'REXAM',
        2070: 'Rio Tinto',
        2071: 'Royal Mail',
        2072: 'Rolls-Royce',
        2073: 'Randgold Resources',
        2074: 'RSA Insurance',
        2075: 'Resolution',
        2076: 'SABMiller',
        2077: 'Sainsbury (J)',
        2078: 'Schroders',
        2079: 'Sage Group',
        2080: 'Shire',
        2081: 'Standard Life',
        2082: 'Smiths Group',
        2083: 'Smith & Nephew',
        2084: 'Sports Direct',
        2085: 'SSE',
        2086: 'Standard Chartered',
        2087: 'Severn Trent',
        2088: 'Tate & Lyle',
        2089: 'Tullow Oil',
        2090: 'Travis Perkins',
        2091: 'Tesco',
        2092: 'TUI Travel',
        2093: 'Unilever',
        2094: 'United Utilities',
        2095: 'Vodafone Group',
        2096: 'Weir Group',
        2097: 'William Hill',
        2098: 'Ferguson PLC',
        2099: 'WPP',
        2100: 'Whitbread',
        1154: 'King Digital Entertainment PLC',
        1155: 'Alibaba',
        1053: 'Yandex NV',
        1054: 'Qiwi Plc',
        1055: 'China Mobile Limited',
        1056: 'Renren Inc.',
        1230: 'Hugo Boss AG',
        2101: 'Daily Mail plc',
        46: 'AUD/CHF',
        1233: 'Air Liquide SA',
        1234: 'AIRBUS GROUP',
        1271: 'A2A Group',
        1276: 'Banco Popolare SC',
        1277: 'BPER Banca',
        1279: 'CNH Industrial Group',
        1280: 'Davide Campari - Milano Beverage',
        1281: 'Enel Group company',
        1283: 'Eni Energy Company',
        1038: 'Honda',
        1046: 'Visa',
        1047: 'Vodafone',
        1048: 'Time-Warner',
        1049: 'Deutsche-Bank',
        1051: 'eBay',
        44: 'USD/RUB',
        45: 'USD/CNH',
        47: 'AUD/CAD',
        48: 'AUD/NZD',
        49: 'EUR/NZD',
        50: 'GBP/AUD',
        51: 'GBP/CHF',
        52: 'GBP/NZD',
        53: 'NZD/CAD',
        54: 'NZD/CHF',
        55: 'NZD/JPY',
        1235: 'Alstom SA',
        1236: 'Alcatel-Lucent',
        1237: 'Danone',
        1238: 'BNP Paribas SA',
        1239: 'Carrefour SA',
        1240: 'Cap Gemini S.A.',
        1241: 'AXA Group',
        1242: 'Vinci S.A',
        1243: 'Electricite de France SA',
        1244: 'Essilor International SA',
        1245: 'Bouygues SA',
        1266: 'Technip SA',
        1273: 'Atlantia Develops',
        1278: 'Buzzi Unicem Group',
        1284: 'Exor Investment Company',
        1285: 'Fiat Chrysler Automobiles',
        1286: 'Leonardo Finmeccanica',
        1287: 'Generali Group',
        1288: 'Intesa Sanpaolo Group',
        1289: 'Luxottica Group',
        1290: 'Mediobanca Investment Bank',
        1291: 'Mediolanum Group',
        1292: 'Moncler',
        1293: 'Mediaset Group',
        1295: 'Bank Of Milano Cooperative Company',
        1296: 'Prysmian Group',
        1297: 'Salvatore Ferragamo Company',
        1298: 'Saipem Oil & Gas Industry',
        1299: 'Snam Group',
        1300: 'STMicroelectronics Company',
        1301: 'Ansaldo STS Company',
        1302: 'Tenaris Group',
        1303: 'Telecom Italia Group',
        1306: 'UBI Banca Group',
        1307: 'UniCredit Commercial Bank',
        1308: 'UnipolSai multi-business insurance company',
        1309: 'World Duty Free Company',
        1310: 'Yoox Net-A-Porter Group',
        1311: 'Abertis',
        1312: 'Abengoa B',
        1313: 'ACS',
        1314: 'Amadeus IT Hold -A-',
        1315: 'Acciona',
        1316: 'BBVA',
        1317: 'Bankia S.A',
        1318: 'Bankinter',
        1319: 'Bolsas Y Mercados',
        1320: 'Caixabank',
        1321: 'DIA S.A.',
        1322: 'Endesa',
        1323: 'Enagas',
        1324: 'Fomento de Construcciones',
        1325: 'Ferrovial',
        1326: 'Gamesa',
        1327: 'Gas Natural SDG',
        1328: 'Grifols A',
        1330: 'Iberdrola',
        1331: 'Indra Sistemas A',
        1332: 'Inditex',
        1333: 'Jazztel',
        1339: 'Repsol',
        1340: 'Banco Sabadell',
        1342: 'Sacyr',
        1344: 'Mediaset Espana',
        1345: 'Tecnicas Reunidas',
        3000: 'SPDR S&P 500 ETF',
        3001: 'Emrg Mkts Index MSCI Ishares',
        3002: ' Gold Miners ETF VanEck Vectors',
        3003: 'Ishares MSCI JAPAN ETF',
        3004: 'Financial Select Sector SPDR',
        3005: 'Ishares Russell 2000 ETF',
        3006: 'Powershares QQQ',
        3007: 'United Stated Oil Fund',
        3008: 'Energy Select Sector SPDR',
        3009: 'EAFE Index MSCI Ishares',
        3010: 'FTSE China 25 Index Fund Ishares',
        3012: 'Brazil Index MSCI Ishares',
        3013: 'Utilities Select Sector SPDR',
        3014: 'Junior Gold Miners ETF VanEck Vectors',
        1357: 'Rosneft OAO',
        1487: 'Sprint Corporation',
        1488: 'Shake Shack Inc',
        1490: 'Target Corp',
        1491: 'Tata Motors Shs Sponsored American Deposit Receipt Repr 5 Shs',
        1492: 'Union Pacific Corp',
        1543: 'Baker Hughes Inc',
        1544: 'Emerson Electric Co',
        1546: 'National Oilwell Varco Inc',
        1547: 'Raytheon Co',
        1548: 'Time Warner Cable Inc',
        1549: 'Arrow Electronics Inc',
        1550: 'Aflac Inc',
        1551: 'Staples Inc',
        1552: 'Abbott Laboratories',
        1553: 'Community Health Systems Inc',
        1554: 'Fluor Corp',
        1555: 'Freeport-McMoRan Inc',
        1556: 'US Bancorp',
        1557: 'Nucor Corp',
        1558: 'Kimberly-Clark Corp',
        1559: 'Hess Corp',
        1560: 'Chesapeake Energy Corp',
        1561: 'Xerox Corp',
        1562: 'Manpower Inc Doing Business As ManpowerGroup',
        1563: 'Danaher Corp',
        1564: 'Whirlpool Corp',
        1565: 'PBF Energy Inc',
        1566: 'HollyFrontier Corp',
        1567: 'Eli Lilly & Co',
        1568: 'Devon Energy Corp',
        1569: 'Progressive Corp',
        1570: 'Cummins Inc (Ex. Cummins Engine Inc)',
        1571: 'Icahn Entrpres Depositary Units Repr Units of LP Interests',
        1573: 'Kohls Corp',
        1574: 'Paccar Inc',
        1202: 'SAP AG',
        1203: 'Bayer AG',
        1204: 'Allianz SE',
        1205: 'E.ON SE',
        1206: 'Daimler AG',
        1207: 'Deutsche Telekom AG',
        1209: 'Linde Aktiengesellschaft',
        1210: 'Volkswagen AG',
        1211: 'Bayerische Motoren Werke Aktiengesellschaft',
        1212: 'M',
        1213: 'RWE AG',
        1214: 'Fresenius Medical Care AG & Co. KGAA',
        1215: 'Adidas AG',
        1216: 'Deutsche Post AG',
        1217: 'Fresenius SE & Co KGaA',
        1218: 'Henkel AG & Co. KGaA',
        1219: 'Deutsche Boerse AG',
        1220: 'ThyssenKrupp AG',
        1221: 'Infineon Technologies AG',
        1222: 'K+S Aktiengesellschaft',
        1223: 'Commerzbank AG',
        1224: 'Merck KGaA',
        1225: 'Beiersdorf AG',
        1226: 'HeidelbergCement AG',
        1227: 'Deutsche Lufthansa Aktiengesellschaft',
        1228: 'Continental AG',
        1229: 'Lanxess AG',
        1246: 'TOTAL S.A.',
        1247: 'Valeo SA',
        1248: 'Societe Generale Group',
        1249: 'Engie SA',
        1250: 'Kering SA',
        1251: 'Lafarge S.A.',
        1252: 'Legrand SA',
        1253: 'LVMH Moet Hennessy Louis Vuitton SA',
        1254: 'Compagnie Generale DES Etablissements Michelin SCA',
        1255: 'ArcelorMittal',
        1256: 'LOreal SA',
        1257: 'Orange',
        1258: 'PUB',
        1259: 'Pernod-Ricard SA',
        1260: 'Renault ',
        1261: 'SAF',
        3024: 'Consumer Discret Select Sector SPDR',
        3025: 'SPDR Gold',
        3026: 'SPDR DOW 30 ETF',
        3027: 'Proshares Ultra S&P 500 ',
        3028: 'Ishares Nasdaq Biotechnology ',
        3029: 'SPDR S&P Midcap 400',
        1462: 'CVS Health Corp',
        1498: 'AmerisourceBergen Corp',
        1524: 'United Continental Holdings Inc',
        1575: 'The Hartford Financial Services Group Inc',
        1576: 'Southwest Airlines Co',
        1577: 'Anadarko Petroleum Corp',
        1578: 'Southern Co',
        1579: 'Supervalu Inc',
        1580: 'Goodyear Tire & Rubber Co',
        1581: 'EOG Resources Inc',
        1582: 'CenturyLink Inc',
        1583: 'Altria Group Inc',
        1584: 'Tenet Healthcare Corp',
        1585: 'General Mills Inc',
        1586: 'ConAgra Foods Inc',
        1587: 'Lear Corp',
        1588: 'United States Steel Corp',
        1589: 'Penske Automotive Group Inc',
        1590: 'AES Corp',
        1591: 'Global Partners LP',
        1592: 'Thermo Fisher Scientific Inc',
        1593: 'PG&E Corp',
        1594: 'NextEra Energy Inc',
        1595: 'American Electric Power Inc',
        1596: 'Baxter International Inc',
        1597: 'Centene Corp',
        1598: 'Bank of New York Mellon Corp',
        1599: 'Jabil Circuit Inc',
        1600: 'PNC Financial Services Group Inc',
        1601: 'Kinder Morgan Inc',
        1602: 'Office Depot Inc',
        1603: 'Bristol-Myers Squibb Co',
        1609: 'Illinois Tool Works Inc',
        1610: 'Murphy USA Inc',
        1611: 'Western Refining Inc',
        1612: 'FirstEnergy Corp',
        1613: 'Aramark',
        1614: 'DISH Network Corp',
        1615: 'Loews Corp',
        1616: 'Ecolab Inc',
        1617: 'Whole Foods Market Inc',
        1618: 'Chubb Corp',
        1620: 'Waste Management Inc',
        1621: 'Apache Corp',
        1622: 'Textron Inc',
        1623: 'Synnex Corp',
        1629: 'Edison International',
        1630: 'Yum Brands Inc',
        1631: 'Parker-Hannifin Corp',
        1632: 'DaVita HealthCare Partners Inc',
        1633: 'CarMax Inc',
        1634: 'Texas Instruments Inc',
        1641: 'Entergy Corp',
        1644: 'Ameriprise Financial Inc',
        1652: 'Norfolk Southern Corp',
        1653: 'PPL Corp',
        1654: 'R.R.Donnelley & Sons Co',
        1655: 'Huntsman Corp',
        1656: 'Bed Bath & Beyond Inc',
        1657: 'Stanley Black & Decker Inc',
        1658: 'L Brands Inc',
        1660: 'Sherwin-Williams Co',
        1661: 'BlackRock Inc',
        1663: 'Ross Stores Inc',
        1665: 'Estee Lauder Companies Inc',
        1666: 'Reinsurance Group America Inc',
        1667: 'Public Service Enterprise Group Inc',
        1668: 'Cameron International Corp',
        1669: 'Navistar International Corp',
        1670: 'CST Brands Inc',
        1671: 'State Street Corp',
        1672: 'Unum Group',
        1673: 'Hilton Worldwide Holdings Inc',
        1674: 'Principal Financial Group Inc',
        1675: 'Reliance Steel And Aluminum Co',
        1676: 'Air Products & Chemicals Inc',
        1677: 'Assurant Inc',
        1678: 'Henry Schein Inc',
        1679: 'Cognizant Technology Solutions Corp',
        1680: 'MGM Resorts International',
        1681: 'WW Grainger Inc',
        1682: 'Group 1 Automotive Inc',
        1683: 'BB&T Corp',
        1684: 'Advance Auto Parts Inc',
        56: 'CAD/CHF',
        1272: 'Autogrill',
        1274: 'Azimut Holding',
        1275: 'Montepaschi Banking Groups',
        1282: 'Enel Power Company',
        3011: 'Russia ETF VanEck Vectors',
        3015: 'DJ US Real Estate Ishares',
        3016: 'SPDR S&P Oil & Gas Exploration & Prod',
        3017: 'Healthcare Select Sector SPDR',
        3018: 'US Natural Gas',
        3019: 'Industrial Select Sector SPDR',
        3020: '20+ Year Trsy Bond Ishares',
        3021: 'Technology Select Sector SPDR',
        3022: 'Consumer Staples Select Sector SPDR',
        3023: 'Iboxx $ High Yield Corporate Bd Ishares',
        1373: 'Qunar Cayman Islands',
        1463: 'EMC Corp',
        1465: 'Gilead Sciences Inc',
        1466: 'GoPro Inc',
        1467: 'Goldman Sachs Group Inc',
        1469: 'Honeywell International Inc',
        1472: 'Kellogg Co',
        1473: 'Michael Kors Holdings Limited',
        1474: 'Lowes Companies Inc',
        1475: 'Macys Inc',
        1476: 'McKesson Corp',
        1477: 'Medtronic PLC',
        1478: 'Metlife Inc',
        1481: 'Booking Holdings Inc',
        1482: 'Philip Morris International Inc',
        1483: 'Phillips 66',
        1484: 'PayPal Holdings',
        1485: 'Qualcomm Inc',
        1486: 'Royal Dutch Shell Shs -B- Sponsored American Deposit Receipt Repr 2 Shs B',
        1495: 'Wells Fargo & Co',
        1496: 'Williams Companies Inc',
        1497: 'Valero Energy Corp',
        1499: 'First Bancorp Inc Maine',
        1500: 'Kroger Co',
        1501: 'General Motors Co',
        1502: 'Express Scripts Holding Co',
        1503: 'Marathon Petroleum Corporation',
        1504: 'Cardinal Health Inc',
        1505: 'Anthem Inc',
        1506: 'FMC Corp',
        1507: 'American International Group Inc',
        1508: 'Dow Chemical Co',
        1509: 'Aetna Inc',
        1510: 'ConocoPhillips Co',
        1511: 'Energy Transfer Equity LP',
        1512: 'Humana Inc',
        1513: 'Enterprise Products Partners LP',
        1514: 'Sysco Corp',
        1515: 'Ingram Micro Inc',
        1516: 'Johnson Controls Inc',
        1517: 'Plains GP Holdings LP',
        1518: 'World Fuel Services Corp',
        1520: 'Best Buy Co Inc',
        1521: 'Delta Air Lines Inc (DE)',
        1522: 'HCA Holdings Inc',
        1523: 'Andeavor',
        1525: 'Tyson Foods Inc',
        1526: 'Deere & Co',
        1527: 'Allstate Corp',
        1528: 'Cigna Corp',
        1529: 'Mondelez International Inc',
        1530: 'Intl FCStone Inc',
        1531: 'Halliburton Co',
        1533: 'Sears Holdings Corp',
        1534: 'General Dynamics Corp',
        1535: 'TJX Companies Inc',
        1536: 'Tech Data Corp',
        1537: 'Avnet Inc',
        1538: 'Exelon Corp',
        1539: 'International Paper Co',
        1540: 'Liberty Interactive Corp',
        1541: 'Duke Energy Corp',
        1542: 'Rite Aid Corp',
        1917: 'Ferrari NV',
        1964: 'Airgas Inc',
        1965: 'GNC Holdings Inc',
        1966: 'Marriott International Inc',
        1967: 'Square, Inc.',
        1968: 'Match Group, Inc',
        1604: 'NRG Energy Inc',
        1605: 'Monsanto Co',
        1606: 'PPG Industries Inc',
        1607: 'Genuine Parts Co',
        1608: 'Omnicom Group Inc',
        1625: 'Viacom Inc',
        1626: 'Lincoln National Corp',
        1627: 'Nordstrom Inc',
        1628: 'C.H.Robinson Worldwide Inc',
        1638: 'ONEOK Inc (New)',
        1639: 'Jacobs Engineering Group Inc',
        1640: 'CSX Corp',
        1642: 'Dominion Resources Inc',
        1643: 'Leucadia National Corp',
        1645: 'VF Corp',
        1646: 'Praxair Inc',
        1647: 'JC Penney Co Inc',
        1648: 'Automatic Data Processing Inc',
        1649: 'L-3 Communications Holdings Inc',
        1650: 'CDW Corp (New)',
        1651: 'Xcel Energy Inc',
        1664: 'Sempra Energy',
        1720: 'Franklin Resources Inc.',
        1721: 'Reynolds American Inc',
        1722: 'Becton Dickinson & Co.',
        1723: 'Broadcom Corporation',
        1725: 'Campbell Soup Co',
        1726: 'AECOM',
        1727: 'Visteon Corp',
        1728: 'Delek US Holdings Inc',
        1729: 'Dover Corp',
        1730: 'BorgWarner Inc',
        1731: 'Jarden Corp',
        1732: 'UGI Corp',
        1733: 'Murphy Oil Corp',
        1734: 'PVH Corp',
        1735: 'Core-Mark Holding Company Inc',
        1751: 'Interpublic Group of Companies Inc',
        1752: 'BlackStone Group LP',
        1759: 'Caseys General Stores Inc',
        1760: 'CMS Energy Corp',
        1761: 'Foot Locker Inc',
        1764: 'Agilent Technologies Inc',
        1765: 'Huntington Ingalls Industries Inc',
        1766: 'Live Nation Entertainment Inc',
        1767: 'Dicks Sporting Goods Inc',
        1768: 'Oshkosh Corp',
        1231: 'Accor S.A.',
        1232: 'Credit Agricole S.A.',
        1346: 'Gazprom OAO',
        1358: 'Sberbank of Russia',
        1359: 'Severstal PAO',
        1360: 'Surgutneftegas OAO',
        1361: 'Tatneft OAO',
        1362: 'Uralkali PJSC',
        1368: 'Qihoo 360 Technology',
        1370: 'Jumei Intl Holdings',
        1371: 'ChangYou.com',
        1377: 'NetEase',
        1378: 'JD.com',
        1379: 'Ctrip.com',
        1380: 'Autohome',
        1382: '51Job',
        1385: 'Global Sources',
        1450: 'Accenture PLC',
        1451: 'American Airlines Group Inc',
        1452: 'AbbVie Inc',
        1454: 'Biogen Inc',
        1457: 'CBS Corp',
        1458: 'Celgene Corp',
        1459: 'Comcast Corp',
        1460: 'Capital One Financial Corp',
        1545: 'Northrop Grumman Corp',
        1691: 'Precision Castparts Corp',
        1698: 'Hormel Foods Corp',
        1700: 'Centerpoint Energy Inc',
        1701: 'Fidelity National Financial Inc',
        1703: 'HD Supply Holdings Inc',
        1704: 'Charter Communications Inc',
        1705: 'Crown Holdings Inc',
        1706: 'Applied Materials Inc',
        1708: 'Avon Products Inc',
        1709: 'Republic Services Inc',
        1769: 'Celanese Corp',
        1770: 'Spirit AeroSystems Holdings Inc',
        1771: 'United Natural Foods Inc',
        1772: 'Peabody Energy Corp',
        1773: 'Owens-Illinois Inc',
        1779: 'Ryder System Inc',
        1796: 'NetApp Inc',
        1798: 'Discovery Communications Inc',
        1799: 'Sanmina Corp',
        1801: 'J.B.Hunt Transport Services Inc',
        1802: 'Charles Schwab Corp',
        1803: 'Ameren Corp',
        1804: 'Mattel Inc',
        1805: 'Laboratory Corp Of America Holdings',
        1823: 'Ingredion Inc',
        1872: 'Raymond James Financial Inc',
        1873: 'Berry Plastics Group Inc',
        1874: 'SCANA Corp',
        1875: 'Cincinnati Financial Corp',
        1876: 'Atmos Energy Corp',
        1878: 'Flowserve Corp',
        1879: 'Simon Property Group Inc',
        1881: 'Burlington Stores Inc',
        1885: 'Ascena Retail Group Inc',
        1886: 'Zillow Group Inc',
        1887: 'Orbital ATK Inc',
        1888: 'Frontier Communications Corporation',
        1890: 'CF Industries Holdings Inc',
        1891: 'The Michaels Companies Inc',
        1892: 'M&T Bank Corporation',
        1893: 'Rush Enterprises Inc',
        1894: 'Keurig Green Mountain Inc',
        1895: 'Superior Energy Services Inc',
        1896: 'Williams-Sonoma Inc',
        1897: 'Robert Half International Inc',
        1898: 'First American Financial Corp',
        1900: 'MDU Resources Group Inc',
        1928: 'VWR Corp',
        1936: 'McCormick & Co Inc',
        1946: 'American Tower Corp',
        1960: 'Silgan Holdings Inc',
        1961: 'Toll Brothers Inc',
        1962: 'Manitowoc Co Inc',
        1963: 'Argo Group',
        1969: 'SolarEdge Technologies',
        1970: 'Fitbit',
        3035: 'iShares AEX UCITS ETF',
        3036: 'iShares Asia Pacific Dividend UCITS ETF',
        3040: 'iShares Core MSCI World UCITS ETF',
        3058: 'iShares J.P. Morgan $ Emerging Markets Bond UCITS ETF',
        3060: 'iShares MSCI AC Far East ex-Japan UCITS ETF',
        3061: 'iShares MSCI Brazil UCITS ETF (Dist)',
        3063: 'iShares MSCI Emerging Markets UCITS ETF (Dist)',
        3066: 'iShares MSCI Europe UCITS ETF (Dist)',
        3068: 'iShares MSCI Japan EUR Hedged UCITS ETF',
        3072: 'iShares MSCI Taiwan UCITS ETF',
        3075: 'iShares S&P 500 UCITS ETF (Dist)',
        1971: 'Nintendo CO Ltd',
        69: 'USD/HUF',
        100001: 'Ethereum',
        3099: 'Credit Suisse AG - VelocityShares Daily Inverse VIX Short Term ETN',
        4001: 'Barrick Gold',
        4002: 'iShares MSCI ACWI Index Fund',
        4003: 'Adecoagro S.A.',
        4004: 'Akamai Technologies',
        4005: 'Akorn',
        4006: 'Allegion',
        4008: 'Affiliated Managers Group',
        4009: 'AutoNation',
        4011: 'ANSYS',
        4013: 'American Railcar Industries Inc',
        4015: 'Axalta Coating Systems',
        4033: 'CME Group',
        4036: 'Carters',
        4037: 'Uniti Group Inc',
        4039: 'CVR Energy',
        4040: 'CVR Refining',
        4041: 'CyberArk',
        4042: 'Donaldson Company',
        4045: 'Now Inc',
        4046: 'Dominos Pizza Inc',
        1262: 'Sanofi',
        1263: 'Compagnie de Saint-Gobain S.A.',
        1264: 'SOLVAY',
        1265: 'Schneider Electric SE',
        1267: 'Peugeot S.A.',
        1268: 'Unibail Rodamco',
        1269: 'Veolia Environnement S.A.',
        1270: 'Vivendi',
        1304: 'Tods Group',
        1305: 'TERNA Eectricity Group',
        1619: 'Health Net Inc',
        1824: 'Navient Corp',
        1826: 'St Jude Medical Inc',
        1827: 'JM Smucker Co',
        1828: 'Clorox Co',
        1831: 'Old Republic International Corp',
        1832: 'Advanced Micro Devices Inc',
        1833: 'Booz Allen Hamilton Holding Corp',
        1834: 'Quintiles Transnational Holdings INC',
        1837: 'Regions Financial Corp',
        1838: 'Lithia Motors Inc',
        1839: 'Salesforce.com Inc',
        1840: 'Alaska Air Group Inc',
        1841: 'Host Hotels & Resorts Inc',
        1842: 'Harman International Industries Inc',
        1843: 'Amphenol Corporation (New)',
        1844: 'Realogy Holdings Corp',
        1845: 'Essendant Inc',
        1846: 'Hanesbrands Inc',
        1847: 'Kindred Healthcare Inc',
        1848: 'ARRIS Group Inc',
        1850: 'LifePoint Health Inc',
        1851: 'Pioneer Natural Resources Company',
        1852: 'Wyndham Worldwide Corp',
        1853: 'Owens Corning Inc',
        1854: 'Alleghany Corp',
        25: 'US Dollar Index',
        4054: 'FireEye',
        4057: 'Flowers Foods',
        4059: 'Fortive Corporation',
        4061: 'GoDaddy Inc.',
        4062: 'Graham Holdings Co - Class B',
        4063: 'CGI Group',
        4064: 'Gaming and Leisure',
        4066: 'Garmin Ltd.',
        4067: 'Globalstar',
        4068: 'GW Pharmaceuticals Plc',
        4069: 'Hain Celestial',
        4070: 'Herbalife',
        4071: 'Herc Holdings',
        4073: 'Hertz Global Holdings Inc',
        4075: 'Interactive Brokers Group',
        4076: 'Intercept Pharma',
        4077: 'Illumina',
        4079: 'Imperva',
        4080: 'Incyte Corp.',
        4081: 'Infosys Limited',
        4083: 'InvenSense',
        4084: 'Ionis Pharmaceuticals',
        4085: 'Ipg Photonics Corp.',
        4086: 'Ingersoll-Rand plc (Ireland)',
        4087: 'Jazz Pharmaceuticals',
        4089: 'The Kraft Heinz Company',
        4091: 'Kronos Worldwide Inc',
        4093: 'Lamar Advertising Company',
        4095: 'Liberty Global A',
        4098: 'Liberty Global PLC LiLAC Class A',
        4130: 'Perrigo Company',
        4133: 'Restaurant Brands International Inc.',
        4135: 'Red Hat',
        4136: 'Transocean LTD',
        4138: 'Roper Technologies Inc',
        4140: 'Spirit Airlines',
        4141: 'SBA Communications Corporation',
        4142: 'Signature Bank',
        4155: 'Sensata Technologies Holding N.V.',
        4157: 'Suncor Energy Inc.',
        4159: 'American Outdoor Brands Corp',
        4160: 'Skyworks Solutions',
        4161: 'Synaptics Inc.',
        68: 'EUR/PLN',
        72: 'CHF/HUF',
        1979: 'Snapchat Inc',
        4210: 'Outfront Media',
        100003: 'Ripple',
        100004: 'Dash',
        3121: 'ISHARES MSCI MEXICO CAPPED',
        3122: 'ISHARES MSCI TAIWAN CAPPED E',
        3124: 'ISHARES IBOXX INVESTMENT GRA',
        3125: 'PIMCO TOTAL RETURN ACTIVE EX',
        100007: 'Ethereum Classic',
        2502: 'Telefonica Deutschlan',
        2503: 'Ceconomy St',
        2504: 'EVOTEC',
        2505: 'KION GROUP',
        2506: 'Schaeffler',
        2508: 'Uniper',
        2516: 'Covestro',
        2518: 'GEA',
        2523: 'Grand City Properties',
        2524: 'TAG Immobilien',
        2525: 'Gerresheimer',
        2526: 'freenet',
        2527: 'Bilfinger',
        1877: 'Pepco Holdings Inc',
        1926: 'Fortune Brands Home & Security Inc',
        4053: 'Federal-Mogul Corp.',
        4185: 'Weatherford International plc',
        4186: 'Willis Towers Watson Public Limited Company',
        4188: '58.com Inc',
        4189: 'Dentsply Sirona Inc.',
        4190: 'Ixia',
        4199: 'Wendy\'s',
        2500: 'Heidelberger Druckmaschinen',
        2528: 'alstria office REIT-AG',
        2529: 'Salzgitter',
        2530: 'Brenntag',
        2531: 'Aareal Bank',
        2536: 'Symrise',
        100020: 'Stellar',
        100023: 'NEO',
        1157: 'Dropbox Inc',
        1915: 'Tutor Perini Corp',
        1916: 'Polaris Industries Inc',
        1918: 'NVR Inc',
        1919: 'Liberty Media Corp',
        1920: 'Energizer Holdings Inc',
        1921: 'Bloomin Brands Inc',
        1922: 'Westlake Chemical Corp',
        1923: 'Hyatt Hotels Corp',
        1924: 'Mead Johnson Nutrition Co',
        1925: 'Envision Healthcare Holdings Inc',
        1930: 'KeyCorp',
        1931: 'Knight Transportation Inc',
        1932: 'Allergan PLC',
        1933: 'Hasbro Inc',
        1934: 'Resolute Forest Products Inc',
        1935: 'Tiffany & Co',
        1937: 'Graphic Packaging Holding Co',
        1938: 'Greif Inc',
        1939: 'Allegheny Technologies Inc',
        1940: 'B/E Aerospace Inc',
        1941: 'Molson Coors Brewing Co',
        1943: 'CNO Financial Group Inc',
        1945: 'Chipotle Mexican Grill Inc',
        1948: 'AmTrust Financial Services Inc',
        1949: 'Brunswick Corp',
        1950: 'Patterson Companies Inc',
        1951: 'Southwestern Energy Co',
        1952: 'AMETEK Inc (New)',
        1953: 'T Rowe Price Group Inc',
        1954: 'Torchmark Corp',
        1955: 'Darling Ingredients Inc',
        1956: 'Leggett & Platt Inc',
        1957: 'Watsco Inc',
        1958: 'Crestwood Equity Partners LP',
        1959: 'Xylem Inc',
        4035: 'Cooper Cos Inc',
        4050: 'Essent Group',
        4074: 'HubSpot',
        4111: 'Monster Beverage Corp',
        4162: 'Syntel',
        4163: 'Transdigm Group Incorporated',
        4164: 'TiVo Corporation',
        4165: 'TRI Pointe Group',
        4179: 'Vertex Pharmaceuticals Incorporated',
        4180: 'Valeant Pharmaceuticals International',
        4181: 'Vista Outdoor Inc.',
        4182: 'Wayfair Inc.',
        4183: 'Waters Corporation',
        4184: 'WABCO Holdings',
        4193: 'Zendesk',
        70: 'EUR/HUF',
        71: 'GBP/HUF',
        100002: 'Bitcoin Cash',
        100005: 'Litecoin',
        1387: 'MOMO Inc ADR',
        1388: 'Take Two Interactive Software Inc',
        2102: '3i Group PLC',
        1927: 'RPM International Inc',
        3079: 'iShares UK Property UCITS ETF',
        57: 'USD/NOK',
        4123: 'Pampa Energia S.A.',
        4124: 'Palo Alto Networks',
        4125: 'Puma Biotechnology Inc',
        4126: 'Pinnacle Foods',
        4128: 'Power Integrations',
        4129: 'Pilgrims Pride',
        2547: 'Drillisch',
        1334: 'Mapfre',
        1336: 'OHL',
        1338: 'Red Electrica Corp',
        1347: 'KazMunaiGas Exploration Production JSC',
        1349: 'Lukoil OAO',
        1350: 'Magnit PJSC',
        1351: 'MegaFon OAO',
        1352: 'MMC Norilsk Nickel OJSC',
        1353: 'NOVATEK OAO',
        1354: 'PhosAgro OAO',
        1461: 'Costco Wholesale Corp',
        1464: 'Twenty-First Century Fox Inc',
        1493: 'United Parcel Service Inc',
        1494: 'Walgreens Boots Alliance Inc',
        1635: 'Wellcare Health Plans Inc',
        1636: 'Marsh & McLennan Cos Inc',
        1637: 'Consolidated Edison Inc',
        1685: 'Ally Financial Inc',
        1686: 'AGCO Corp',
        1687: 'Corning Inc',
        1689: 'Stryker Corp',
        1690: 'Molina Healthcare Inc',
        1692: 'Discover Financial Services',
        1693: 'Genworth Financial Inc',
        1694: 'Eastman Chemical Co',
        1695: 'Dean Foods Co',
        1696: 'Autozone Inc',
        1697: 'Owens & Minor Inc',
        1699: 'GameStop Corp New',
        1707: 'CBRE Group Inc',
        1710: 'Universal Health Services Inc',
        1711: 'Darden Restaurants Inc',
        1712: 'Steel Dynamics Inc',
        1713: 'Suntrust Banks Inc',
        1714: 'Caesars Entertainment Corp',
        1715: 'Targa Resources Corp',
        1716: 'Dollar Tree Inc',
        1717: 'News Corp',
        1718: 'Ball Corp',
        1719: 'Masco Corp',
        1736: 'Calpine Corp',
        1737: 'D.R. Horton Inc',
        1738: 'Weyerhaeuser Co',
        1739: 'KKR & Co LP',
        1740: 'FMC Technologies Inc',
        1741: 'SpartanNash Company',
        1742: 'WESCO International Inc',
        1743: 'Quanta Services Inc',
        1744: 'Mohawk Industries Inc',
        1745: 'Lennar Corp',
        1746: 'TravelCenters of America LLC',
        1747: 'Sealed Air Corp',
        1748: 'Eversource Energy',
        1749: 'Coca-Cola Enterprises Inc',
        1750: 'Ashland Inc',
        1702: 'Sonic Automotive Inc',
        1753: 'Quest Diagnostics Inc',
        1757: 'Newmont Mining Corp',
        1758: 'OReilly Automotive Inc',
        1763: 'Commercial Metals Co',
        1774: 'Dillards Inc',
        1775: 'Level 3 Communications Inc',
        1776: 'LKQ Corp',
        1777: 'Symantec Corp',
        1778: 'Buckeye Partners L P',
        1780: 'Rockwell Automation Inc',
        1781: 'Dana Holding Corp',
        1782: 'NCR Corp',
        1783: 'Expeditors International of Washington',
        1785: 'Ak Steel Holding Corp',
        1786: 'Fifth Third Bancorp',
        1788: 'Nisource Inc',
        1789: 'Cablevision Systems Corp',
        1790: 'Anixter International Inc',
        1791: 'Emcor Group Inc',
        1792: 'Fidelity National Information Services Inc',
        1793: 'Barnes & Noble Inc',
        1794: 'KBR Inc',
        1795: 'Avery Dennison Corp',
        1806: 'Starwood Hotels & Resorts Worldwide Inc',
        1807: 'General Cable Corp',
        1808: 'Albany Molecular Research Inc',
        1809: 'HRG Group Inc',
        1811: 'Spectra Energy Corp',
        1812: 'Asbury Automotive Group Inc',
        1813: 'Packaging Corp of America',
        1815: 'PulteGroup Inc',
        1816: 'JetBlue Airways Corp',
        1817: 'Newell Rubbermaid Inc',
        1819: 'Calumet Specialty Products Partners LP',
        1820: 'Expedia Inc Del',
        1821: 'American Financial Group Inc',
        1822: 'United Rentals Inc',
        1835: 'Wynn Resorts Ltd',
        1836: 'Jones Lang Lasalle Inc',
        1855: 'S&P Global Inc',
        1856: 'Big Lots Inc',
        1857: 'Northern Tier Energy LP',
        1858: 'Markel Corp',
        1859: 'Leidos Holdings Inc',
        1860: 'Rockwell Collins Inc',
        1864: 'The Hanover Insurance Group Inc',
        1865: 'Fiserv Inc',
        1866: 'ABM Industries Inc',
        1867: 'Sonoco Products Co',
        1868: 'Harris Corp',
        1870: 'Wisconsin Energy Corp',
        1882: 'Bemis Co Inc',
        1883: 'Coach Inc',
        1884: 'Continental Resources Inc',
        1901: 'Juniper Networks Inc',
        1902: 'Arthur J.Gallagher & Co',
        1903: 'Colfax Corp',
        1905: 'MasTec Inc',
        1906: 'Lam Research Corp',
        1907: 'Axiall Corp',
        1909: 'Cintas Corp',
        1910: 'Coty Inc',
        1911: 'Andersons Inc',
        1912: 'Valspar Corp',
        1913: 'Northern Trust Corp',
        1914: 'Intuit Corp',
        26: 'China A50 Index',
        73: 'USD/PLN',
        1400: 'Nestle SA',
        1402: 'Roche Holding Ltd',
        1403: 'Credit Suisse Group AG',
        1404: 'ABB LTD',
        1410: 'Givaudan S.A',
        1411: 'Lafargeholcim Ltd',
        1412: 'Swisscom AG',
        1413: 'SGS SA',
        1414: 'Swiss Life Holding AG',
        1415: 'Swiss Re AG',
        1416: 'Syngenta AG',
        1417: 'UBS Group AG',
        1418: 'The Swatch Group SA - B Shares',
        1419: 'Zurich Insurance Group Ltd',
        1972: 'Regeneron Pharmaceuticals',
        1973: 'Sangamo Biosciences Inc',
        1977: 'Cellectis SA',
        1978: 'Hermes International',
        3100: 'iShares Barclays 1-3 Year Treasry Bnd Fd',
        3101: 'iShares Barclays 7-10 Year Trasry Bnd Fd',
        3102: 'PowerShares DB Agriculture Fund',
        3103: 'Teucrium Corn Fund',
        3104: 'Teucrium Wheat Fund',
        3105: 'United States Gasoline Fund',
        4016: 'BlackBerry Limited',
        4017: 'Bitauto Holdings Limited',
        4018: 'Brookfield Property Partners L.P.',
        4020: 'Banco Santander Chile',
        4021: 'Anheuser-Busch Inbev Sa',
        4023: 'CalAtlantic Group',
        4024: 'Caesars Acquisition',
        4026: 'Cavium Inc',
        4027: 'China Biologic',
        4028: 'Cerner Corp.',
        4029: 'Churchill Downs Inc.',
        4031: 'CIT Group',
        4047: 'Brinker Intl.',
        4048: 'Edgewell Personal Care',
        4058: 'FleetCor Technologies',
        4096: 'Liberty Global C',
        4099: 'Linear Technology Corporation',
        4102: 'Cheniere Energy Inc',
        4104: 'Liberty Media Corporation Series A Liberty SiriusXM Common Stock',
        4105: 'Mid-America Apartment',
        4106: 'Moodys Corp.',
        4107: 'Media General',
        4108: 'MercadoLibre',
        4109: 'Welbilt Inc',
        4110: 'Makemytrip',
        4114: 'MUELLER WATER PRODUCTS',
        4115: 'Maxlinear Inc',
        4116: 'National Instruments Corporation',
        4117: 'New Relic',
        4118: 'Nielsen N.V.',
        4119: 'Nuance Communications',
        4143: 'Service Corp Intl',
        4145: 'SEI Investments Company',
        4146: 'ServiceMaster Global Holdings',
        4147: 'Seattle Genetics',
        4148: 'Shopify Inc.',
        4149: 'Signet Jewelers Limited (us)',
        4153: 'Stericycle',
        4166: 'Tempur Sealy',
        4167: 'Trimble Inc.',
        4168: 'Travelport',
        4169: 'Under Armour',
        4170: 'Ubiquiti Networks',
        4171: 'USG Corporation',
        4172: 'Varian Medical Systems',
        4173: 'Viavi Solutions',
        4174: 'Vipshop',
        4176: 'VMware',
        4177: 'Verisk Analytics',
        4178: 'Verisign',
        4191: 'Yelp Inc.',
        4194: 'Zoetis',
        4072: 'Hershey Co',
        4201: 'The Chemours',
        4202: 'Lazard',
        4203: 'Credit Acceptance',
        4204: 'Renaissancere Holdings',
        4205: 'Aon plc',
        4206: 'CommScope Holding Co Inc',
        4207: 'Sally Beauty',
        4208: 'The Dun & Bradstreet',
        4209: 'Post holdings',
        4211: 'Marcus & Millichap',
        4212: 'Fastenal Company',
        4213: 'Cia Cervecerias unidas',
        4214: 'Four Corners Property Trust',
        4215: 'RE/MAX Holdings',
        4216: 'Blackhawk Network Holdings',
        3111: 'SPDR DOW JONES REIT ETF',
        3030: 'iShares $ Corporate Bond UCITS ETF',
        3048: 'iShares Emerging Markets Local Government Bond UCITS ETF',
        3052: 'iShares FTSE 100 UCITS ETF (Dist)',
        3054: 'iShares FTSE MIB UCITS ETF (Dist)',
        3080: 'VIX Short-Term Futures ETN Ipath',
        58: 'USD/SEK',
        59: 'NOK/SEK',
        60: 'EUR/NOK',
        61: 'EUR/SEK',
        62: 'USD/TRY',
        63: 'USD/MXN',
        64: 'USD/SGD',
        65: 'GBP/CAD',
        66: 'ZAR/JPY',
        1405: 'Adecco Group AG',
        1406: 'Actelion Ltd',
        1407: 'Julius Baer Gruppe AG',
        1408: 'Compagnie Financiere Richemont SA',
        1409: 'Geberit AG',
        1974: 'Intellia Therapeutics Inc',
        1975: 'Editas Medicine Inc',
        1976: 'Morgan Stanley',
        4121: 'NXP Semiconductors',
        4122: 'Pandora Media',
        4196: 'Boyd Gaming',
        4197: 'Six Flags',
        4198: 'W.R Grace',
        4200: 'Legg Mason',
        3118: 'ISHARES MSCI SOUTH KOREA CAP',
        2501: 'AIXTRON',
        2509: 'Nordex',
        2510: 'SGL Carbon',
        2511: 'Evonik',
        2512: 'Deutsche Wohnen',
        2513: 'LANXESS',
        2514: 'QIAGEN',
        2515: 'Dialog Semiconductor',
        2519: 'Rocket Internet',
        2520: 'Wirecard',
        2521: 'Zalando',
        2522: 'Sudzucker',
        2532: 'PATRIZIA Immobilien',
        2533: 'United Internet',
        2534: 'LEONI',
        2535: 'Siltronic',
        2537: 'RTL',
        2538: 'Software',
        2539: 'STADA',
        2540: 'Deutsche Euroshop',
        2541: 'Hella',
        2542: 'Hapag-Lloyd',
        2543: 'ElringKlinger',
        2544: 'OSRAM',
        2545: 'HUGO BOSS',
        2546: 'MorphoSys',
        2548: 'CTS Eventim',
        1156: 'Spotify ',
    }


def load_id_typeid():
    global id_typeid
    obj = get_json_resp('https://api.etorostatic.com/sapi/instrumentsmetadata/V1.1/instruments')
    datas = obj['InstrumentDisplayDatas']
    for data in datas:
        id_typeid[data['InstrumentID']] = data['InstrumentTypeID']
    return id_typeid


def write(html, filename):
    fp = open(filename, "w")
    fp.write(html)
    fp.close()
    print("write over")


def write_excel(filename, alldata, flag=None):
    if flag:
        filename = filename.replace('.xls', '_' + str(flag) + '.xls')
    d = os.path.dirname(filename)
    if not os.path.exists(d):
        os.makedirs(d)

    i = 0
    while len(alldata) > 65500:
        _filename = filename.replace('.xls', '_%s.xls' % i)
        start_index = 0
        end_index = 65500
        data = alldata[start_index:end_index]
        alldata = alldata[end_index:]
        w = xlwt.Workbook(encoding='utf-8')
        ws = w.add_sheet('old', cell_overwrite_ok=True)
        for row in range(0, len(data)):
            one_row = data[row]
            for col in range(0, len(one_row)):
                try:
                    ws.write(row, col, one_row[col][:32766])
                except:
                    try:
                        ws.write(row, col, one_row[col])
                    except:
                        print('===Write excel ERROR===' + str(one_row[col]))
        w.save(_filename)
        print("%s===========over============%d" % (_filename, len(data)))
        i += 1
    w = xlwt.Workbook(encoding='utf-8')
    ws = w.add_sheet('old', cell_overwrite_ok=True)
    for row in range(0, len(alldata)):
        one_row = alldata[row]
        for col in range(0, len(one_row)):
            try:
                ws.write(row, col, one_row[col][:32766])
            except:
                try:
                    ws.write(row, col, one_row[col])
                except:
                    print('===Write excel ERROR===' + str(one_row[col]))
    w.save(filename)
    print("%s===========over============%d" % (filename, len(alldata)))


def request_sheet1():
    global sheet1_data, P_ID
    for i in range(1, PAGE_SIZE+1):
        url = 'https://www.etoro.com/sapi/rankings/rankings/?blocked=false&bonusonly=false&copyblock=false&istestaccount=false&optin=true&page=%d&pagesize=20&period=OneYearAgo&sort=-maxmonthlyriskscore' % i
        print(url)
        try:
            obj = get_json_resp(url)
            items = obj.get('Items', [])
            for item in items:
                profile_id = 'ID_%d' % P_ID
                name = item['UserName']
                cid = item['CustomerId']
                if name in name_set:
                    continue
                name_set.add(name)
                profile_url = 'https://www.etoro.com/people/%s/stats' % name
                country = item['Country']
                week_dd = '%.2f%%' % item['WeeklyDD']
                copiers = item['Copiers']
                _return = '%.2f%%' % item['Gain']
                risk = item['MaxMonthlyRiskScore']
                copiers_gain = '%.2f%%' % item['CopiersGain']
                one_row = [profile_id, name, _return, risk, copiers, copiers_gain, week_dd, country, profile_url, cid]
                sheet1_data.append(one_row)
                P_ID += 1
                if P_ID > 20000:
                    break
        except Exception as e:
            print('EXP======%s' % url)
            print(str(e))
    write_excel('data/sheet1.xlsx', sheet1_data)


def request_history(profile_id, name, cid):
    global sheet3_data
    instrument_dict = load_ins_dict()
    total_url = 'https://www.etoro.com/sapi/trade-data-real/history/public/credit/flat/aggregated?CID=%d&StartTime=2017-04-13T16:00:00.000Z' % cid
    total_obj = get_json_resp(total_url)
    history_size = total_obj.get('TotalClosedTrades', 0)
    page_size = min(history_size // 100 + 2, 10)
    print(profile_id, name, page_size)
    for i in range(1, page_size):
        history_url = 'https://www.etoro.com/sapi/trade-data-real/history/public/credit/flat?CID=%d&ItemsPerPage=100&PageNumber=%d&StartTime=2017-04-13T16:00:00.000Z' % (cid, i)
        try:
            print(history_url)
            obj = get_json_resp(history_url)
            historys = obj.get('PublicHistoryPositions', [])
            for history in historys:
                action = 'Buy' if history.get('IsBuy') else 'Sell'
                _open = history['OpenRate']
                _close = history['CloseRate']
                p_l = '%.2f%%' % history['NetProfit']
                instrument_name = instrument_dict.get(history['InstrumentID'], history['InstrumentID'])
                one_row = [profile_id, name, instrument_name, action, _open, _close, p_l]
                sheet3_data.append(one_row)
        except Exception as e:
            print('EXP======%s' % history_url)
            print(str(e))


def get_date(ori_str):
    try:
        timestamp = int(time.mktime(datetime.strptime(ori_str, "%Y-%m-%d").timetuple()))
        ret = datetime.fromtimestamp(int(timestamp)).strftime('%d/%m/%Y')
        return ret
    except:
        return 'N/A'


def remove_html_tag(ori):
    dr = re.compile(r'<[^>]+>', re.S)
    dd = dr.sub('', ori)
    return str(html.unescape(dd))


def get_json_resp(url):
    resp = requests.get(url, headers={
        'Cookie': cookie,
        'Accept': 'application/json, text/plain, */*',
        'user-agent': 'Mozilla/5.0 (Macintosh; Intel Mac OS X 10_12_0) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/54.0.2840.98 Safari/537.36'
    }, timeout=10)
    if resp.status_code == 200:
        return resp.json()
    return {}


def get_request(url):
    header = {
        'cookie': cookie,
    }
    res_data = requests.get(url, headers=header, timeout=10)
    res = res_data.content.decode("utf-8")
    res = res.replace('\t', '').replace('\r', '').replace('\n', '')
    return html.unescape(res)


def request_sheet3(filename, start=1):
    print('process -> ' + filename)
    data = xlrd.open_workbook(filename, encoding_override="cp1252")
    table = data.sheets()[0]

    for i in range(15000, table.nrows):
        row = table.row(i)
        try:
            profile_id = row[0].value
            name = row[1].value
            c_id = row[9].value
            request_history(profile_id, name, c_id)
        except Exception as e:
            print(str(i) + ' -> ' + str(e))
    write_excel('data/sheet3.xls', sheet3_data)


def request_details(profile_id, name, cid):
    global id_typeid, sheet2_data
    profile_url = 'https://www.etoro.com/sapi/rankings/cid/%d/rankings/?Period=OneYearAgo' % cid
    profile_obj = get_json_resp(profile_url)
    profitableWeeksPct = '%.2f%%' % profile_obj['Data']['ProfitableWeeksPct']
    total_trades = profile_obj['Data']['Trades']
    weeksSinceRegistration = profile_obj['Data']['WeeksSinceRegistration']
    trade_per_week = '%.2f' % (total_trades / weeksSinceRegistration)

    hour_url = 'https://www.etoro.com/sapi/userstats/stats/username/%s/trades/oneYearAgo?CopyAsAsset=true' % name
    hour_obj = get_json_resp(hour_url)
    minutes = hour_obj.get('all', {}).get('avgHoldingTimeInMinutes', 0)
    hour = '%.1f' % (minutes / 60)
    assets = hour_obj.get('assets')
    assets_perc = {}
    for asset in assets:
        if asset['isMirror'] or not asset.get('instrumentId'):
            continue
        iid = asset['instrumentId']
        typeid = id_typeid[iid]
        assets_perc[typeid] = assets_perc.get(typeid, 0) + asset['pctOfTrades']
    sorted_perc = sorted(assets_perc.items(), key=operator.itemgetter(1), reverse=True)

    activate_url = 'https://www.etoro.com/sapi/userstats/gain/cid/%d/history' % cid
    activate_obj = get_json_resp(activate_url)
    activate_date = get_date(activate_obj.get('monthly', [{"start": "2017-10-20T12:36:10.543Z"}])[0]['start'].split('T')[0])

    for perc in sorted_perc:
        type_name = TYPEID_NAME.get(perc[0])
        one_row = [profile_id, name, type_name, "%.2f%%" % perc[1], trade_per_week, hour, activate_date, profitableWeeksPct]
        sheet2_data.append(one_row)
    print(one_row)


def request_sheet2(filename, start=1):
    print('process -> ' + filename)
    data = xlrd.open_workbook(filename, encoding_override="cp1252")
    table = data.sheets()[0]

    for i in range(13398, table.nrows):
        row = table.row(i)
        try:
            profile_id = row[0].value
            name = row[1].value
            c_id = row[9].value
            request_details(profile_id, name, c_id)
        except Exception as e:
            print(str(i) + ' -> ' + str(e))
    write_excel('data/sheet2.xls', sheet2_data)

# request_sheet3('data/sheet1.xls')
load_id_typeid()
request_sheet2('data/sheet1_Overall.xls')

